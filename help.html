<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L/R Master 機能ガイド</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ヘルプページ専用の追加スタイル */
        body {
            /* アプリ本体より少し幅広で見やすく */
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: var(--bg);
            color: var(--text);
        }
        h1.guide-title {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
        }
        section {
            background: var(--card);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        h2 {
            color: var(--accent);
            border-bottom: 2px solid rgba(128,128,128,0.2);
            padding-bottom: 10px;
            margin-top: 0;
        }
        h3 {
            color: var(--text);
            margin-bottom: 10px;
        }
        p {
            line-height: 1.6;
            opacity: 0.9;
        }
        .screen-mockup {
            border: 2px dashed rgba(128,128,128,0.3);
            padding: 15px;
            border-radius: 12px;
            background: rgba(128,128,128,0.05);
            margin: 20px 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 600px) {
            .feature-grid { grid-template-columns: 1fr; }
        }
        /* スコアバッジのスタイル (feature_scoring.jsより抽出) */
        .score-badge {
            display: inline-block;
            background: #0f172a;
            color: #fff;
            font-size: 1rem;
            font-weight: 800;
            padding: 4px 10px;
            border-radius: 50px;
            margin-left: 10px;
            vertical-align: middle;
        }
        .score-high { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .score-mid { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .score-low { background: linear-gradient(135deg, #ef4444, #b91c1c); }
    </style>
</head>
<body>

<div style="margin-bottom: 20px;">
    <a href="index.html" style="
        display: inline-flex;
        align-items: center;
        text-decoration: none;
        color: var(--primary);
        font-weight: bold;
        background: var(--card);
        padding: 8px 16px;
        border-radius: 50px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    ">
        ⬅ アプリに戻る
    </a>
</div>

<h1 class="guide-title">📘 L/R Master 機能ガイド</h1>

<section>
    <h2>はじめに</h2>
    <p>L/R Masterは、日本人が苦手とする英語の「L」と「R」の発音と聞き取りを、AIの力と視覚的な補助を使って徹底的にトレーニングするためのアプリです。</p>
    <p>このアプリは完全に日本語化されており、初心者でも簡単に使えるよう設計されています。AIによる100点満点のスコアリングと具体的なアドバイス、豊富な拡張機能で、楽しく継続的に学習できます。</p>
</section>

<section>
    <h2>2つのメインモード</h2>
    <div class="feature-grid">
        <div>
            <h3>🎤 発音モード</h3>
            <p>表示された単語をマイクに向かって発音し、AIが正しく発音できているかを判定します。100点満点のスコアと具体的なアドバイスが表示されます。</p>
            <div class="screen-mockup container" style="box-shadow:none; margin:0; width:auto;">
                <div class="mode-toggle"><button class="active">🎤 発音</button><button>👂 聞き取り</button></div>
                <div class="word-display">light</div>
                <div class="sub-text">vs right</div>
                <div class="controls">
                    <button class="action-btn btn-model">🔊 お手本</button>
                    <button class="action-btn btn-main">🎤 開始</button>
                </div>
            </div>
        </div>
        <div>
            <h3>👂 聞き取りモード</h3>
            <p>流れてくる音声を聞いて、それが「L」の単語か「R」の単語かをクイズ形式で答えます。連続正解数もカウントされます。</p>
            <div class="screen-mockup container" style="box-shadow:none; margin:0; width:auto;">
                <div class="mode-toggle"><button>🎤 発音</button><button class="active">👂 聞き取り</button></div>
                <div class="word-display blur">??????</div>
                <div class="sub-text">vs ??????</div>
                <div class="controls" style="grid-template-columns: 1fr 1fr;">
                    <button class="choice-btn">L</button>
                    <button class="choice-btn">R</button>
                </div>
            </div>
        </div>
    </div>
</section>

<section>
    <h2>発音のコツを「目で見て」理解する</h2>
    <p>発音モードでは、音素ボタンを押すことで、その音を出すときの正しい「口の形」と「舌の位置」を図解で確認できます。お手本音声（🔊 お手本）も再生可能です。</p>
    <div class="screen-mockup container" style="box-shadow:none; margin:0 auto; max-width: 500px;">
        <div class="phoneme-container">
            <div class="phoneme-btn">/l/</div>
            <div class="phoneme-btn active">/r/</div>
            <div class="phoneme-btn">/ai/</div>
            <div class="phoneme-btn">/t/</div>
        </div>
        <div class="diagram-box" style="display:flex;">
            <div class="mouth-diagram">
                <svg viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg">
                    <path fill="none" stroke="#cbd5e1" stroke-width="2" d="M10,50 Q10,10 45,10 Q80,10 80,50 Q80,90 45,90 Q10,90 10,50" />
                    <circle cx="45" cy="60" r="10" fill="none" stroke="#333" stroke-width="2"/>
                    <path d="M40,65 Q45,55 50,65" fill="#ef4444"/>
                </svg>
            </div>
            <div class="diagram-text">
                <h4>R-Shape <span style="font-size:0.7em; color:var(--accent);">R_SHAPE</span></h4>
                <p>★重要: 舌先をどこにも触れないように後ろへ引きます。唇を少し丸めると出しやすくなります。</p>
            </div>
        </div>
    </div>
</section>

<section>
    <h2>AIによる採点とフィードバック</h2>
    <p>発音すると、AIが即座に判定を行います。「正解/不正解」だけでなく、100点満点でのスコアと、改善のための具体的なアドバイスが表示されます。判定には以下の3つのAIプロバイダーから選択可能です。</p>
    <ul>
        <li><strong>Google Gemini (推奨):</strong> 高速かつ高精度。マルチモーダルな理解力を活かし、的確なアドバイスを提供。無料枠で十分実用可能。</li>
        <li><strong>OpenAI (Whisper + GPT-4o-mini):</strong> 世界最高峰の音声認識モデル「Whisper」による正確な文字起こしと、GPTによる自然なアドバイス。API利用料が発生。</li>
        <li><strong>Web Speech API (ブラウザ標準):</strong> APIキー不要・完全無料・爆速。簡易的な判定となり、アドバイスは汎用的なものになります。</li>
    </ul>
    <div class="feature-grid">
        <div>
            <h3>🎉 正解の例 (高得点)</h3>
            <div class="screen-mockup">
                <div class="feedback correct" style="background:#dcfce7; color:#166534;">
                    🎉 正解！ <span class="score-badge score-high">95</span><br>
                    <small style="opacity:0.8;">聞き取り: "light"</small>
                </div>
            </div>
            <p>ネイティブに近い発音ができると、緑色の高得点バッジが表示されます。</p>
        </div>
        <div>
            <h3>⚠️ 不正解の例 (アドバイス付き)</h3>
            <div class="screen-mockup">
                <div class="feedback incorrect" style="background:#fee2e2; color:#991b1b;">
                    ⚠️ right <span class="score-badge score-low">45</span><br>
                    <small style="font-weight:bold;">💡 舌先が上の歯茎に触れてしまっています。「R」は舌をどこにも触れずに後ろに引いてください。</small>
                </div>
            </div>
            <p>惜しい場合や間違った場合は、スコアと共に、AIが具体的な改善点を日本語で教えてくれます。</p>
        </div>
    </div>
</section>

<section>
    <h2>音声を可視化する「ビジュアライザー」</h2>
    <p>画面中央の黒いボックスは、あなたの声をリアルタイムで視覚化します。タップすることで3つのモード（波形、声紋、スペクトル）を切り替えられます。</p>
    <div class="screen-mockup container" style="box-shadow:none; margin:0 auto; max-width: 500px; background:#020617; color:white; border:none;">
        <div style="height:80px; position:relative; background: linear-gradient(to bottom, #000, #00f, #f00, #ff0); opacity:0.8;">
            <div style="position:absolute; top:2px; right:5px; font-size:0.6rem; color:rgba(255,255,255,0.5);">声紋</div>
            <div style="position:absolute; top:40%; left:0; width:100%; height:2px; background:rgba(255,255,255,0.5);"></div>
            <div style="position:absolute; top:35%; left:10px; font-size:0.7rem; color:rgba(255,255,255,0.8);">F3 (注目エリア)</div>
        </div>
        <div style="font-size: 0.8rem; color: rgba(255,255,255,0.8); padding: 5px; background: rgba(128,128,128,0.2);">
            【声紋 (Spectrogram)】下から3本目の線(F3)に注目。RはF3がグッと下がり、Lは高いまま維持されます。
        </div>
    </div>
    <p style="margin-top: 15px;"><strong>3つのモード:</strong></p>
    <ul>
        <li><strong>波形 (WAVE)</strong>: 音のリズムや強弱を確認</li>
        <li><strong>声紋 (SPECTROGRAM)</strong>: L/R識別の鍵となる第3フォルマント（F3）の変化を視覚的に確認</li>
        <li><strong>スペクトル (SPECTRUM)</strong>: 声の高さの成分分布を表示</li>
    </ul>
</section>

<section>
    <h2>便利な拡張機能</h2>
    <p>学習をサポートする豊富な拡張機能が搭載されています。設定画面から各機能をオン/オフできます。</p>
    
    <h3>📊 学習記録グラフ</h3>
    <p>画面右上の「📊」ボタンを押すと、日々の学習記録（正解・不正解の数）が棒グラフで表示され、成長を実感できます。Chart.jsを使用した視覚的な分析が可能です。</p>

    <h3>👥 お手本との重ね合わせ再生</h3>
    <p>録音後、「▶️ 自分の声を再生」の下に表示される「👥 比較（重ね合わせ）」ボタンを押すと、自分の録音とお手本の音声が同時に再生されます。リズムやイントネーションのズレを直感的に比較できます。</p>
    <div class="screen-mockup" style="text-align:center;">
        <button style="background: #dcfce7; color: #166534; border: 1px solid #86efac; padding: 8px; border-radius: 8px; font-weight:bold;">▶️ 自分の声を再生</button><br>
        <button style="margin-top: 10px; background: #6366f1; color: white; border: none; padding: 8px; border-radius: 8px; font-weight:bold;">👥 比較（重ね合わせ）</button>
    </div>

    <h3>⚡ ブリッツモード</h3>
    <p>制限時間30秒内にL/Rを聞き分ける早押しゲームです。聞き取りモードで「⚡ Blitz」ボタンが表示されます。スコアを競いながら集中力を鍛えることができます。</p>

    <h3>🔥 早口言葉チャレンジ</h3>
    <p>L/Rを含む難易度別の早口言葉を練習できます。4段階の難易度（Lv1: Basic → Lv2: Sentence → Lv3: Hard → Lv4: Nightmare）から選択可能です。設定画面で有効化すると、レベル選択に早口言葉カテゴリが追加されます。</p>

    <h3>📝 センテンスモード</h3>
    <p>単語だけでなく、実践的な短い文章でL/Rの発音を練習します。シャドーイング形式で、より実践的な会話フレーズを学習できます。設定画面で有効化すると、レベル選択にセンテンスカテゴリが追加されます。</p>

    <h3>🪞 ミラーモード</h3>
    <p>Webカメラで自分の口の形をリアルタイム確認できます。発音図解と自分の口を同時に見比べて練習することで、より正確な発音を身につけられます。設定画面で有効化すると、発音図解の横にミラーボタンが表示されます。</p>

    <h3>🎯 フォルマントゲーム</h3>
    <p>F3（第3フォルマント）の変化を視覚的に捉えるゲームです。音声分析の理解を深め、L/Rの違いを科学的に学べます。設定画面で有効化すると、ビジュアライザーがF3ゲーム専用モードに切り替わります。</p>

    <h3>🏆 ランクシステム</h3>
    <p>累計正解数（XP）に基づいて称号を獲得できるRPG風の成長システムです。8段階のランク（🌱 初心者 → 🥚 見習い → 🛡️ 戦士 → ⚔️ 騎士 → 🧙‍♂️ 魔導士 → 👑 達人 → 🐲 伝説 → 🌌 発音神）があり、継続的な学習をサポートします。設定画面で有効化すると、ヘッダー下にランクバーが表示されます。</p>

    <h3>🎉 祝賀演出</h3>
    <p>高得点（90点以上）や連勝（5問連続正解）時に紙吹雪を舞わせる演出機能です。学習のモチベーション向上に役立ちます。設定画面で有効化できます（デフォルト: ON）。</p>

    <h3>💡 カタカナヒント</h3>
    <p>L/Rの単語に対応するカタカナ表記を自動表示します。発音のイメージを掴みやすくする補助機能です。設定画面で有効化できます（デフォルト: ON）。</p>

    <h3>🎭 反応マスコット</h3>
    <p>正解・不正解に反応するアニメーションマスコットが表示されます。楽しく学習を続けられる演出機能です。設定画面で有効化できます（デフォルト: OFF）。</p>
</section>

<section>
    <h2>その他の機能</h2>
    
    <h3>📝 単語リスト管理 (Word List Manager)</h3>
    <p>画面右上の「📝」ボタンから、収録されている単語リストの確認や編集、新しいレベルの作成、データのインポート/エクスポートが可能です。</p>
    <ul>
        <li><strong>レベル管理:</strong> 複数のレベル（basic, intermediate, advanced, business等）を作成・管理</li>
        <li><strong>単語ペアの追加:</strong> L/Rの単語ペアを追加し、音素データも設定可能</li>
        <li><strong>インポート/エクスポート:</strong> JSON形式でデータのバックアップや共有</li>
        <li><strong>アニメーションデータ:</strong> 各単語に音素データを設定すると、発音図解が表示されます</li>
    </ul>

    <h3>⚙️ 設定</h3>
    <p>画面右上の「⚙️」ボタンから、各種設定が行えます。</p>
    <ul>
        <li><strong>AIプロバイダー:</strong> Google Gemini、OpenAI、Web Speech APIから選択</li>
        <li><strong>APIキー設定:</strong> 選択したプロバイダーのAPIキーを入力</li>
        <li><strong>モデル選択:</strong> Gemini選択時は利用可能なモデルから選択</li>
        <li><strong>再生速度調整:</strong> お手本音声の再生速度を0.5x〜1.5xで調整</li>
        <li><strong>拡張機能の有効化:</strong> 各拡張機能を個別にオン/オフ</li>
    </ul>

    <h3>🌙 ダークモード</h3>
    <p>画面右上の「🌙」ボタンで、目に優しいダークモードに切り替えられます。夜間の学習時にも快適に使用できます。</p>

    <h3>🔄 自動次へ / 🗣️ 自動停止</h3>
    <p>画面上部のチェックボックスで、以下の機能を有効/無効にできます。</p>
    <ul>
        <li><strong>🔄 自動次へ:</strong> 正解時に自動で次の問題に進む</li>
        <li><strong>🗣️ 自動停止:</strong> 発音終了を自動検知して録音を停止（VAD: Voice Activity Detection）</li>
    </ul>

    <h3>📜 履歴表示</h3>
    <p>画面下部に過去の回答履歴が表示されます。正解・不正解、聞き取り結果、スコアを確認できます。</p>
</section>

<div style="text-align:center; margin-top:30px; margin-bottom:50px;">
    <a href="index.html" style="background:var(--primary); color:white; padding:12px 30px; text-decoration:none; border-radius:50px; font-weight:bold; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);">アプリに戻る</a>
</div>

</body>
</html>